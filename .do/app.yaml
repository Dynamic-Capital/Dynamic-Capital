spec:
  name: dynamic-capital
  envs:
    - key: NODE_ENV
      value: production
      scope: RUN_AND_BUILD_TIME
    - key: SITE_URL
      value: https://dynamic-capital.ondigitalocean.app
      scope: RUN_AND_BUILD_TIME
    - key: NEXT_PUBLIC_SITE_URL
      value: https://dynamic-capital.ondigitalocean.app
      scope: RUN_AND_BUILD_TIME
    - key: NEXT_PUBLIC_SUPABASE_URL
      value: https://qeejuomcapbdlhnjqjcc.supabase.co
      scope: RUN_AND_BUILD_TIME
    - key: NEXT_PUBLIC_SUPABASE_ANON_KEY
      value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFlZWp1b21jYXBiZGxobmpxamNjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyMDE4MTUsImV4cCI6MjA2OTc3NzgxNX0.GfK9Wwx0WX_GhDIz1sIQzNstyAQIF2Jd6p7t02G44zk
      scope: RUN_AND_BUILD_TIME
    - key: SUPABASE_SERVICE_ROLE_KEY
      scope: RUN_TIME
    - key: CDN_BUCKET
      scope: RUN_AND_BUILD_TIME
    - key: CDN_REGION
      scope: RUN_AND_BUILD_TIME
    - key: CDN_ACCESS_KEY
      scope: RUN_AND_BUILD_TIME
    - key: CDN_SECRET_KEY
      scope: RUN_AND_BUILD_TIME
  services:
    - name: web
      source_dir: .
      environment_slug: node-js
      build_command: "cd apps/web && npm ci && npm run build"
      run_command: "cd apps/web && PORT=$PORT npm start"
      envs:
        - key: SITE_URL
          value: https://dynamic-capital.ondigitalocean.app
          scope: RUN_AND_BUILD_TIME
        - key: NEXT_PUBLIC_SITE_URL
          value: https://dynamic-capital.ondigitalocean.app
          scope: RUN_AND_BUILD_TIME
      http_port: 8080
      instance_count: 1
      instance_size_slug: basic-xxs
      routes:
        - path: /
      health_check:
        http_path: /
