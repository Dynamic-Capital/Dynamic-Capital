-- Remove unused indexes identified by Supabase lint to reduce write overhead
DO $$
DECLARE
  idx text;
BEGIN
  FOREACH idx IN ARRAY ARRAY[
    'public.idx_user_surveys_completed_at',
    'public.idx_media_files_uploaded_by',
    'public.idx_auto_reply_templates_active',
    'public.idx_media_files_created_at',
    'public.idx_broadcast_messages_status',
    'public.idx_broadcast_messages_scheduled',
    'public.idx_chat_sessions_user_id',
    'public.idx_chat_sessions_telegram_id',
    'public.idx_chat_messages_session_id',
    'public.idx_chat_messages_created_at',
    'public.idx_daily_analytics_date',
    'public.idx_user_interactions_user_id',
    'public.idx_user_interactions_date',
    'public.idx_bot_users_vip_admin',
    'public.idx_user_sessions_telegram_active',
    'public.idx_user_sessions_last_activity',
    'public.idx_user_interactions_telegram_created',
    'public.idx_user_subscriptions_telegram_active',
    'public.idx_user_subscriptions_plan_active',
    'public.idx_education_enrollments_telegram_status',
    'public.idx_education_enrollments_package_status',
    'public.idx_plan_channels_plan_id_active',
    'public.idx_session_audit_telegram_user',
    'public.idx_bot_sessions_telegram_user_id',
    'public.idx_bot_sessions_session_start',
    'public.idx_bot_sessions_active',
    'public.idx_profiles_telegram_id',
    'public.idx_profiles_role',
    'public.idx_assignments_user_id',
    'public.idx_assignments_package_id',
    'public.idx_assignments_active',
    'public.idx_memberships_user_id',
    'public.idx_memberships_channel_id',
    'public.idx_memberships_telegram_user_id',
    'public.idx_user_subscriptions_telegram_user_id',
    'public.idx_user_subscriptions_active',
    'public.idx_user_interactions_telegram_user_id',
    'public.idx_payments_status',
    'public.idx_payments_user_plan',
    'public.idx_media_files_telegram_file_id',
    'public.idx_user_subscriptions_user_status',
    'public.idx_bot_users_admin_vip',
    'public.idx_subscription_plans_active',
    'public.idx_payments_user_status',
    'public.idx_bot_sessions_user_active',
    'public.idx_promotions_active_code',
    'public.idx_media_files_telegram_file',
    'public.idx_admin_stats_composite',
    'public.idx_payment_analytics',
    'public.idx_bot_content_key_active',
    'public.idx_bot_users_telegram_id_lookup',
    'public.idx_user_subscriptions_active_lookup',
    'public.idx_bot_settings_key_active',
    'public.idx_payments_plan_id',
    'public.idx_promotion_usage_promotion_id',
    'public.idx_education_packages_category_id',
    'public.idx_education_enrollments_package_id',
    'public.idx_broadcast_messages_media_file_id',
    'public.idx_bot_users_active_admin',
    'public.idx_bot_users_telegram_id',
    'public.idx_bot_users_is_admin',
    'public.idx_bot_users_is_vip',
    'public.idx_bot_users_created_at',
    'public.idx_user_interactions_type_created',
    'public.idx_payments_user_id',
    'public.idx_payments_status_created',
    'public.idx_user_subscriptions_status_date',
    'public.idx_promo_analytics_created_at',
    'public.idx_promo_analytics_promo_code',
    'public.idx_education_enrollments_telegram_user_id',
    'public.idx_education_enrollments_status',
    'public.idx_education_packages_active',
    'public.idx_promotions_active',
    'public.idx_admin_logs_admin_telegram_id',
    'public.idx_admin_logs_action_type',
    'public.idx_user_interactions_user_type_date',
    'public.idx_payments_user_status_date',
    'public.idx_ton_subdomains_user_id',
    'public.idx_ton_subdomains_subdomain',
    'public.idx_ton_subdomains_verified',
    'public.idx_domain_cache_expires',
    'public.idx_subdomain_claims_status',
    'public.idx_subdomain_claims_user_id',
    'public.idx_ton_tx_hash',
    'public.idx_ton_tx_user',
    'public.idx_ton_tx_status',
    'public.idx_ton_tx_created',
    'public.idx_enrollment_audit_student_id',
    'public.idx_channel_memberships_added_by',
    'public.idx_channel_memberships_package_id',
    'public.idx_user_package_assignments_assigned_by',
    'public.idx_bot_users_current_plan_id',
    'public.idx_user_analytics_telegram_user_id',
    'public.idx_user_analytics_event_type',
    'public.idx_user_analytics_created_at',
    'public.idx_user_analytics_session_id',
    'public.idx_education_enrollments_student_telegram_id',
    'public.idx_user_sessions_active',
    'public.idx_email_campaigns_status',
    'public.idx_email_campaigns_scheduled',
    'public.idx_email_recipients_campaign',
    'public.idx_auto_reply_templates_created_at',
    'public.idx_email_recipients_status',
    'public.idx_auto_reply_templates_is_active',
    'public.idx_email_recipients_email'
  ] LOOP
    EXECUTE format('DROP INDEX IF EXISTS %s', idx);
  END LOOP;
END $$;
