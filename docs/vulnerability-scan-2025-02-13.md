# Vulnerability Scan â€” 2025-02-13

## Scan Context
- **Command:** `npm audit --json`
- **Node version:** v20.19.4
- **Generated report:** [`docs/vulnerability-scan-2025-02-13.json`](./vulnerability-scan-2025-02-13.json)

## Summary of Findings
- **Total vulnerabilities:** 9
- **Critical:** 1 (`elliptic` transitively via `@ethersproject/signing-key`)
- **High:** 6 (primarily through the `ws` WebSocket dependency chain impacting Ethers and Web3 Onboard packages)
- **Moderate:** 1 (`svelte` build tooling)
- **Low:** 1 (`@ethersproject/signing-key`)
- **Fix availability:** 4 issues report an available update, while 5 remain without an automated fix (`ws`-related advisories and packages pinned to affected ranges).

## Detailed Results
| Package | Severity | Introduced via | Fix availability | Notes |
| --- | --- | --- | --- | --- |
| `elliptic` | Critical | `@ethersproject/signing-key` | Yes | Multiple advisories including private key exposure (GHSA-vjh7-7g9h-fjfh). Update to a patched release once compatible.
| `@ethersproject/providers` | High | `ws` | No | Affected by `ws` DoS vulnerability (GHSA-3h5v-q93c-6h6q); upstream fix pending in provider dependency chain.
| `@web3-onboard/core` | High | `ethers`, `svelte` | No | Impacted by unresolved `ws` and `svelte` advisories inherited from dependency tree.
| `@web3-onboard/common` | High | `viem` | Yes | Upgrade `@web3-onboard/common`/`viem` to versions pulling a patched WebSocket stack.
| `ethers` | High | `@ethersproject/providers`, `@ethersproject/signing-key` | No | Blocked by `ws` and `elliptic` advisories; monitor for upstream releases.
| `viem` | High | `ws` | Yes | Update to a release newer than `2.15.0` to pick up `ws@8.17.1` or newer.
| `ws` | High | `@ethersproject/providers`, `viem` | No | DoS vulnerability under advisories GHSA-3h5v-q93c-6h6q; requires upstream patches.
| `svelte` | Moderate | `svelte` | No | Patched in Svelte 4.2.19; upgrading from 3.x to 4.x requires migration work across Web3 Onboard dependencies.
| `@ethersproject/signing-key` | Low | `elliptic` | Yes | Will be resolved once `elliptic` is upgraded to >=6.6.1.

## Recommended Next Steps
1. Track upstream releases for `ws` (>=8.17.1) and ensure dependent packages (`@ethersproject/providers`, `viem`, `@web3-onboard/*`) can adopt patched versions.
2. Evaluate bumping `elliptic` and related Ethers packages once compatibility with the application's web3 integration is verified.
3. Re-run `npm audit` after dependency updates to confirm remediation progress.
